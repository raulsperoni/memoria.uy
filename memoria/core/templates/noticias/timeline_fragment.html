{# templates/noticias/timeline_fragment.html #}

<div id="timeline-container" class="max-w-2xl mx-auto">
  <div class="bg-white shadow rounded p-6">
    <h2 class="text-2xl font-semibold mb-2">Comparte la Noticia</h2>
    <p class="text-gray-600 mb-4">
      Memoria.uy te permite llevar un registro de las noticias gubernamentales para que, en 4 años, puedas revisar los hechos y recordar cómo te hicieron sentir. ¡Contribuye y forma parte de la historia!
    </p>
    <form method="post" action="{% url 'noticia-create' %}"
          hx-post="{% url 'noticia-create' %}" hx-target="#timeline-container" hx-swap="outerHTML">
      {% csrf_token %}
      <!-- URL Input Field -->
      <div class="mb-4">
        {{ form.enlace }}
      </div>
      <!-- Voting Buttons -->
      <div class="mb-4">
        <p class="text-gray-700 mb-2">Guardar noticia como:</p>
        <div class="flex flex-col md:flex-row gap-2">
          <button type="submit" name="opinion" value="buena"
            class="flex-1 px-4 py-2 rounded text-sm bg-gray-200 hover:bg-green-300 text-gray-700">
            Buena noticia
          </button>
          <button type="submit" name="opinion" value="mala"
            class="flex-1 px-4 py-2 rounded text-sm bg-gray-200 hover:bg-red-300 text-gray-700">
            Mala noticia
          </button>
          <button type="submit" name="opinion" value="neutral"
            class="flex-1 px-4 py-2 rounded text-sm bg-gray-200 hover:bg-yellow-300 text-gray-700">
            Ni buena ni mala
          </button>
        </div>
      </div>
      <!-- Spinner: visible while the form is submitting -->
      <div class="flex justify-center">
        <svg class="hidden animate-spin h-5 w-5 text-blue-500" hx-indicator xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4l-2-2-2 2V4a8 8 0 00-4 8h4z"></path>
        </svg>
      </div>
    </form>
  </div>
  <!-- Filter bar -->
  <div class="p-1 my-2">
    <!-- Filter Bar -->
    <div id="filter-bar" class="my-4 flex space-x-2">
      <button hx-get="{% url 'timeline' %}?filter=buena" 
              hx-target="#timeline-items" 
              hx-swap="innerHTML" 
              class="px-4 py-2 bg-green-500 text-white rounded">
        Buenas Noticias
      </button>
      <button hx-get="{% url 'timeline' %}?filter=mala" 
              hx-target="#timeline-items" 
              hx-swap="innerHTML" 
              class="px-4 py-2 bg-red-500 text-white rounded">
        Malas Noticias
      </button>
      <!-- Optionally add a button to show all news -->
      <button hx-get="{% url 'timeline' %}" 
              hx-target="#timeline-items" 
              hx-swap="innerHTML" 
              class="px-4 py-2 bg-gray-500 text-white rounded">
        Todas
      </button>
    </div>
  </div>
  <!-- Timeline Items -->
  <div id="timeline-items" class="timeline mt-6">
    {% include "noticias/timeline_items.html" %}
  </div>
</div>
