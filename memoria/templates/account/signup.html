{% extends "base.html" %}

{% load i18n %}
{% load account socialaccount %}

{% block content %}
<div class="max-w-lg mx-auto bg-white border-4 border-black p-6 md:p-8 mt-8 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]">
  <h2 class="text-3xl font-bold mono mb-2">Crear cuenta</h2>
  
  <p class="text-sm mono text-gray-600 mb-6">
    // Guardá tus votos. Mostrá tu posición en el mapa.
  </p>

  <!-- Benefits Reminder -->
  <div class="bg-gray-50 border-2 border-black p-4 mb-6">
    <p class="text-xs mono font-bold mb-2">Beneficios de crear cuenta:</p>
    <ul class="text-xs mono space-y-1 text-gray-700">
      <li>✓ Guardar votos entre dispositivos</li>
      <li>✓ Alias opcional en el mapa (podés elegir)</li>
      <li>✓ Emails semanales (podés activar/desactivar)</li>
    </ul>
  </div>

  <form class="signup space-y-4" id="signup_form" method="post" action="{% url 'account_signup' %}">
    {% csrf_token %}
    
    {% if form.errors %}
      <div class="bg-red-50 border-2 border-red-600 p-4 mb-4">
        <p class="font-bold mono text-sm mb-2">⚠ Corregí los errores:</p>
        {{ form.non_field_errors }}
        {% for field in form %}
          {% for error in field.errors %}
            <p class="text-xs mono text-red-700">• {{ field.label }}: {{ error }}</p>
          {% endfor %}
        {% endfor %}
      </div>
    {% endif %}
    
    {% for field in form %}
      <div class="form-field">
        {% if field.field.widget.input_type == 'checkbox' %}
          {# Checkbox fields - inline layout #}
          <label for="{{ field.id_for_label }}" class="flex items-start gap-3 cursor-pointer">
            {{ field }}
            <span class="text-sm mono">{{ field.label }}</span>
          </label>
          {% if field.help_text %}
            <p class="text-xs mono text-gray-600 mt-1 ml-7">{{ field.help_text }}</p>
          {% endif %}
        {% else %}
          {# Text/Email/Password fields - block layout #}
          <label for="{{ field.id_for_label }}" class="block text-sm mono font-bold mb-2">
            {{ field.label }}{% if field.field.required %} *{% endif %}
          </label>
          {{ field }}
          {% if field.help_text %}
            <p class="text-xs mono text-gray-600 mt-1">{{ field.help_text }}</p>
          {% endif %}
        {% endif %}
      </div>
    {% endfor %}
    
    {% if redirect_field_value %}
      <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
    {% endif %}
    
    <button type="submit" class="w-full py-3 px-4 bg-black text-white font-bold mono border-2 border-black hover:bg-white hover:text-black transition-all shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]">
      → Crear cuenta
    </button>
  </form>

  <div class="mt-6 pt-6 border-t-2 border-gray-300">
    <p class="text-center text-xs mono text-gray-600">
      ¿Ya tenés cuenta? 
      <a href="{{ login_url }}" class="text-black font-bold hover:underline">Iniciá sesión</a>
    </p>
  </div>
</div>

<script>
  // Add brutalist monospace styling to form fields (but not checkboxes)
  document.addEventListener('DOMContentLoaded', function() {
    // Style text/email/password inputs
    const inputFields = document.querySelectorAll('input[type="text"], input[type="email"], input[type="password"]');
    inputFields.forEach(field => {
      // Remove any existing classes that might conflict
      field.className = '';
      // Add brutalist styling
      field.classList.add('w-full', 'px-4', 'py-3', 'border-2', 'border-black', 'mono', 'text-sm', 'focus:outline-none', 'focus:ring-2', 'focus:ring-black');
    });
    
    // Style checkboxes
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
      if (!checkbox.className) {
        checkbox.classList.add('w-4', 'h-4', 'border-2', 'border-black', 'focus:ring-2', 'focus:ring-black');
      }
    });
  });
</script>
{% endblock %}