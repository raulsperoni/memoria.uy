{% extends "base.html" %}

{% load i18n %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white border-2 border-black p-8 mt-10 mono">
  <h1 class="text-2xl font-bold mb-6 border-b-2 border-black pb-2">
    > cerrar sesión
  </h1>

  <p class="text-sm text-gray-600 mb-6">
    ¿Estás seguro que querés cerrar sesión?
  </p>

  <form method="post" action="{% url 'account_logout' %}" id="logout-form">
    {% csrf_token %}
    {% if redirect_field_value %}
    <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}"/>
    {% endif %}

    <div class="flex gap-4">
      <button type="submit" class="py-3 px-6 bg-black text-white hover:bg-gray-800 transition-colors border-2 border-black font-semibold">
        [cerrar sesión]
      </button>
      <a href="{% url 'timeline' %}" class="inline-block py-3 px-6 border-2 border-black hover:bg-black hover:text-white transition-colors font-semibold">
        [cancelar]
      </a>
    </div>
  </form>
</div>

<script>
  // Clean up extension session on logout
  document.getElementById('logout-form').addEventListener('submit', function() {
    // Clear extension session cookie
    document.cookie = 'memoria_extension_session=; path=/; max-age=0; SameSite=Lax';

    // Clear extension session from localStorage
    localStorage.removeItem('memoria_extension_session');

    console.log('[Memoria Logout] Cleared extension session cookie and localStorage');
  });
</script>
{% endblock %}