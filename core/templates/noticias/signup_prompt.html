<!-- templates/noticias/signup_prompt.html -->
{% if show_signup_prompt %}
<div id="signup-prompt-banner" 
     hx-swap-oob="true"
     class="fixed bottom-4 right-4 left-4 md:left-auto md:max-w-md z-50
            bg-white border-4 border-black p-4 
            shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]
            animate-[slideUp_0.4s_ease-out]"
     data-total-votes="{{ total_votes }}">
  <button onclick="this.closest('#signup-prompt-banner').remove(); trackEvent('signup-prompt-dismiss', {total_votes: {{ total_votes }}, action: 'close'});" 
          class="absolute top-2 right-2 text-xl hover:text-gray-600 transition"
          aria-label="Cerrar">
    ‚úï
  </button>
  
  <div class="flex items-start gap-3 mb-3">
    <div class="text-3xl">üó∫Ô∏è</div>
    <div class="flex-1">
      <p class="text-base mono font-bold mb-2">
        ¬°Ya votaste en {{ total_votes }} noticias!
      </p>
      <p class="text-xs mono text-gray-700 mb-3">
        Cre√° tu cuenta para desbloquear:
      </p>
      <ul class="text-xs mono space-y-1.5 text-gray-700 mb-4">
        <li class="flex items-start gap-2">
          <span class="text-green-600 font-bold">‚úì</span>
          <span><strong>Guardar tus votos</strong> entre dispositivos</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 font-bold">‚úì</span>
          <span><strong>Tu alias</strong> en el mapa de opiniones</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-green-600 font-bold">‚úì</span>
          <span><strong>Email semanal</strong> con nuevas noticias</span>
        </li>
      </ul>
    </div>
  </div>
  
  <div class="flex flex-col sm:flex-row gap-2">
    <a href="{% url 'account_signup' %}?next={% url 'timeline' %}" 
       onclick="trackEvent('signup-prompt-click', {total_votes: {{ total_votes }}, action: 'signup'});"
       class="flex-1 text-center bg-black text-white px-4 py-2.5 text-sm mono font-bold
              border-2 border-black hover:bg-white hover:text-black transition-all">
      Crear cuenta gratis
    </a>
    <button onclick="this.closest('#signup-prompt-banner').remove(); trackEvent('signup-prompt-dismiss', {total_votes: {{ total_votes }}, action: 'continue'});" 
            class="text-xs mono text-gray-600 hover:text-black underline">
      Seguir sin cuenta
    </button>
  </div>
</div>

<script>
  // Track signup prompt shown
  document.addEventListener('DOMContentLoaded', function() {
    const prompt = document.getElementById('signup-prompt-banner');
    if (prompt) {
      const totalVotes = prompt.getAttribute('data-total-votes');
      trackEvent('signup-prompt-shown', {
        total_votes: parseInt(totalVotes) || 0
      });
    }
  });
</script>

<style>
@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
{% endif %}
